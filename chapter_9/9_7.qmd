## 转换为线性回归 {#sec-9_7}
在许多情况下，响应均值（*输出值的均值*）明显不是输入水平（*输入值*）的线性函数。在这种情况下，如果可以确定输入水平和其响应均值之间的关系形式，那么有时可以通过变量变换将其转换为线性形式。例如，在某些应用中，已知信号在 $t$ 时刻处的振幅 $W(t)$ 近似满足：

$W(t) \approx c e^{-dt}$

对上式去对数运算，则可以表示为：

$\log W(t) \approx \log c - dt$

如果令 $Y = \log W(t)$，$\alpha = \log c$，$\beta = -d$，则模型 $W(t) \approx c e^{-dt}$ 可以转换为：

$Y = \alpha + \beta t + e$

然后，我们可以利用最小二乘法来估计简单线性回归模型的回归参数 $\alpha$ 和 $\beta$，于是 $W(t) \approx c e^{-dt}$ 可以用如下方式来预测：

$W(t) \approx e^{A + Bt}$

::: {#exr-9_7_a}
下表给出了在不同温度（摄氏度）下进行实验时所使用的化学物质的百分比。使用这些数据估计：如果实验在 350 度下进行，那么需要使用的化学物质的百分比是多少？

| 温度 | 百分比 |
|-------------|------------|
| 5°          | 0.061      |
| 10°         | 0.113      |
| 20°         | 0.192      |
| 30°         | 0.259      |
| 40°         | 0.339      |
| 50°         | 0.401      |
| 60°         | 0.461      |
| 80°         | 0.551      |
:::


::: {#sol-9_7_a}
```{r}
#| label: fig-9_7
#| fig-cap: "@exr-9_7_a"
#| warning: false
#| 

x <- c(5, 10, 20, 30, 40, 50, 60, 80)
y <- c(0.061, 0.113, 0.192, 0.259, 0.339, 0.401, 0.461, 0.551)
plot(x, y)
```
设 $P(x)$ 为在温度 $10x$ 时所使用的化学物质的百分比。尽管如 @fig-9_7 所示，$P(x)$ 看起来大致呈线性关系，但我们可以通过考虑 $x$ 和 $P(x)$ 之间的非线性关系来改进模型的拟合效果。具体而言，我们考虑以下形式的关系：

$1 - P(x) \approx c(1 - d)^x$

也就是说，假设在温度为 $x$ 的实验中，所用化学物质的百分比大约以指数速率减少。对上式进行对数运算后，可以写成：

$\log(1 - P(x)) \approx \log(c) + x \log(1 - d)$

令：

$\begin{align}Y &= - \log (1-P) \\ \alpha &= - \log c \\ \beta &= - \log (1-d) \end{align}$

我们得到了一般的回归方程：

$Y = \alpha + \beta x + e$

为了看出数据是否支持这个模型，我们需要画出 $x$ 和 $- \log (1-P)$ 的散点图。@tbl-9_2 给出了转换后的数据，@fig-9_8 给出了对应的散点图。

| 温度 | $- \log (1-P)$ |
|-------------|------------|
| 5°          | 0.063      |
| 10°         | 0.120      |
| 20°         | 0.213      |
| 30°         | 0.300      |
| 40°         | 0.414      |
| 50°         | 0.512      |
| 60°         | 0.618      |
| 80°         | 0.801      |
: {#tbl-9_2}


```{r}
#| label: fig-9_8
#| fig-cap: ""
#| warning: false
#| 

x <- c(5, 10, 20, 30, 40, 50, 60, 80)
y <- c(0.061, 0.113, 0.192, 0.259, 0.339, 0.401, 0.461, 0.551)
y1 <- -log(1 - y)
plot(x, y1)
```

使用 R 得到 $\alpha$ 和 $\beta$ 的最小二乘估计值（@sec-9_2）：

```{r}
#| code-fold: false

x <- c(5, 10, 20, 30, 40, 50, 60, 80)
y <- c(0.061, 0.113, 0.192, 0.259, 0.339, 0.401, 0.461, 0.551)
y1 <- -log(1 - y)

B <- (sum(x * y1) - mean(x) * sum(y1)) / (sum(x^2) - length(x) * mean(x)^2)
A <- mean(y1) - B * mean(x)

B
A
```

于是得到 $c$ 和 $d$ 的估计值：

$\begin{align} \hat{c} &= e^{-A} = 0.9847 \\ 1 - \hat{d} &= e^{-B} = 0.9901 \end{align}$

最后得到估计的函数关系为：

$\hat{P} = 1 - 0.9847 \cdot (0.9901)^x$

如上模型的残差 $P - \hat{P}$ 如 @tbl-9_3 所示。

|  x  |   P   |  $\hat{P}$  |  $P - \hat{P}$  |
|-----|-------|---------------|-------------------|
|  5  | 0.061 | 0.063         | -0.002            |
| 10  | 0.113 | 0.109         |  0.040            |
| 20  | 0.192 | 0.193         | -0.001            |
| 30  | 0.259 | 0.269         | -0.010            |
| 40  | 0.339 | 0.339         |  0.000            |
| 50  | 0.401 | 0.401         |  0.000            |
| 60  | 0.461 | 0.458         |  0.003            |
| 80  | 0.551 | 0.556         | -0.005            |
: {#tbl-9_3}

$\blacksquare$
:::
