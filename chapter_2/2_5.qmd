## 正态分布数据集 {#sec-2_5}
我们在实践中观察到的许多大数据集都具有形状相似的直方图。通常，这些直方图在样本中位数处达到峰值，然后在中位数的两侧以钟形对称的形式下降。我们称这样的数据集为正态数据集，称其直方图为正态直方图。@fig-2_5_norm-1 展示了一个正态数据集的直方图。

如果一个数据集的直方图接近正态直方图，我们说该数据集近似正态分布。例如，我们会说图 @fig-2_5_norm-2 给出的直方图来自一个近似正态的数据集，而图 @fig-2_5_norm-3 和图 @fig-2_5_norm-4 给出的直方图则不是近似正态的数据集（因为每个直方图都太不对称）。与样本中位数不是近似对称的任何数据集都是偏态（*skewed*）分布。如果数据集的长尾在中位数右侧，则称为 “右偏”；如果数据集的长尾在中位数左侧，则称为 “左偏”。因此，图 @fig-2_5_norm-3 中的数据集为左偏分布，而 @fig-2_5_norm-4 中的数据集为右偏分布。

```{r}
#| label: fig-2_5_norm
#| fig-cap: "不同数据集的直方图"
#| fig-subcap:
#|   - "正态分布"
#|   - "近似正态分布"
#|   - "左偏分布"
#|   - "右偏分布" 
#| layout-ncol: 2
#| warning: false

library(ggplot2)

x <- seq(1, 19)
y <- 100 - 10 * abs(x - mean(x))
df <- data.frame(value=rep(x, y))

ggplot(df, aes(x=value)) +
  geom_histogram(bins=19)


x <- seq(1, 19)
y <- 100 - 10 * abs(x - mean(x))
value <- rep(x, y)
value <- value[value != 17]
df <- data.frame(value=value)

ggplot(df, aes(x=value)) +
  geom_histogram(bins=19)

df <- data.frame(value=rbeta(10000, 5, 2))
ggplot(df, aes(x=value)) +
  geom_histogram(bins=19)

df <- data.frame(value=rbeta(10000, 1, 5))
ggplot(df, aes(x=value)) +
  geom_histogram(bins=19)
```

从正态直方图的对称性可以看出，一个近似正态分布的数据集，其样本均值和样本中位数大致相等。

假设 $\overline{x}$ 和 $s$ 分别是近似正态分布数据集的样本均值和样本标准差。**经验法则**（*empirical rule*）指定了观察到的数据位于 $s$、$2s$、$3s$ 个样本均值 $x\overline{x}$ 内的大致比例。

### 经验法则
如果一个数据集是一个近似正态分布的数据集，其样本均值和样本标准差分别是 $\overline{x}$ 和 $s$，那么有如下的正确结论：

1. 大约有 68% 的观察数据会位于 $\overline{x} \pm s$ 区间内
2. 大约有 95% 的观察数据会位于 $\overline{x} \pm 2s$ 区间内
3. 大约有 99% 的观察数据会位于 $\overline{x} \pm 3s$ 区间内

::: {.exr-2_5_a}
如下的数据是工业工程专业的学生在统计学考试中的分数：

```{.bash}
43, 46, 52, 55, 55, 56, 58, 60, 62, 63, 64, 66, 66, 72, 74, 74, 75, 77, 77, 78, 83, 85, 85, 87, 88, 90, 91, 94
```

通过其茎叶图，我们会发现如上数据的直方图近似正态分布。接下来我们用这份数据来评估一下经验法则。

```{r}
scores <- c(43, 46, 52, 55, 55, 56, 58, 60, 62, 63, 64, 66, 66, 72, 74, 74, 75, 77, 77, 78, 83, 85, 85, 87, 88, 90, 91, 94)
stem(scores)
```
:::

::: {#sol-sec-2_5_a}
计算得到数据集的样本均值和样本方差：$\overline{x} \thickapprox 70.571$，$s \thickapprox 14.354$。因此，根据经验法则：

* 有 68% 的数据会位于 56.2~84.9 之间，但是实际上，数据集中只有 $\frac{15}{28} \%$ 也就是 53.6% 的数据位于56.2~84.9 之间。
* 有 95% 的数据会位于 41.68~99.28 之间，但是实际上，数据集中所有的数据都位于 41.68~99.28 之间。
:::

如果一个总体是由多个不同类型的子总体而构成，那么从这个总体中抽样得到的数据集通常不是正态分布。这种数据集的直方图通常看起来像是多个正态直方图的组合或叠加，因此在这种直方图上通常会有多个局部峰值。由于这些局部峰值处的直方图比其邻近值更高，因此这些峰值类似于众数。如 @fig-bio_peaks 所示，在直方图中，具有两个局部峰值的数据集称之为双峰分布。

```{r}
#| label: fig-bio_peaks
#| fig-cap: "双峰分布直方图"
#| warning: false

samples1 <- rnorm(10000, mean=1, sd=1)  
samples2 <- rnorm(10000, mean=5, sd=1)
df <- data.frame(value=c(samples1, samples2))

ggplot(df, aes(x=value)) +
    geom_histogram()
```